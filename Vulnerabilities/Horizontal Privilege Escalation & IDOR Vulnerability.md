 ğŸ§¾ Horizontal Privilege Escalation & IDOR Vulnerability

## ğŸ§  What is Horizontal Privilege Escalation?

Horizontal privilege escalation occurs when a user is able to **access resources or perform actions authorized for another user with the same privilege level**. 

> ğŸ” For example, if a regular user (User A) can view or edit the account information of another regular user (User B), this is a horizontal privilege escalation issue.

---

## ğŸ”“ Common Scenario: Insecure Direct Object Reference (IDOR)

A common cause of horizontal privilege escalation is **IDOR** â€” *Insecure Direct Object Reference*.

**Example:**

```
GET https://insecure-website.com/myaccount?id=123
```

If the `id` parameter is user-controllable and not properly validated on the server side, an attacker can modify the value:

```
GET https://insecure-website.com/myaccount?id=124
```

â¡ï¸ If the server doesn't check that the current user is authorized to access `id=124`, then User A can access User Bâ€™s data.

---

## ğŸ§± How Applications Try to Prevent This

Some applications use **non-predictable identifiers** (e.g., GUIDs) instead of simple numeric IDs.

Example:
```
GET /user/6f0a3f8e-e3a6-4d9c-b76b-02880b85d712
```

This makes guessing harder â€” but it **doesnâ€™t eliminate the risk** if the GUIDs are exposed somewhere else in the app (e.g., in message threads, reviews, or public profiles).

---

## âœ… Takeaways

- Always validate ownership or access rights **on the server side**.
- Donâ€™t rely on obscurity (like using GUIDs) to secure access.
- Watch for any feature where users can pass IDs or resource references â€” test those for IDOR vulnerabilities.